<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Joki Gendong Naik Gunung Roblox - Petualangan Puncak!</title>
  <!-- 
    WARNING: cdn.tailwindcss.com should not be used in production.
    To use Tailwind CSS in production, install it as a PostCSS plugin or use the Tailwind CLI:
    https://tailwindcss.com/docs/installation
  -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Bungee+Spice&family=Press+Start+2P&family=Luckiest+Guy&family=Fredoka+One&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Fredoka One', cursive; /* Friendly, rounded font */
      background-color: #87CEEB; /* Sky blue background */
      color: #333; /* Darker text for contrast */
      background-image: url('https://www.transparenttextures.com/patterns/cubes.png'); /* Subtle pattern */
      background-attachment: fixed;
    }
    h1, h2, h3, h4 {
      font-family: 'Luckiest Guy', cursive; /* Bold, playful font for headings */
      text-shadow: 3px 3px #FFD700; /* Gold shadow */
      color: #FF4500; /* Orange-red for headings */
    }
    .header-title {
        font-family: 'Bungee Spice', cursive; /* Extra playful for main title */
        text-shadow: 4px 4px #FFD700, 6px 6px #FF6347; /* Multi-layer shadow */
        color: #FFFFFF; /* White main text */
    }
    .btn-primary {
      background-image: linear-gradient(to right, #FF6347, #FF4500); /* Tomato to OrangeRed */
      transition: all 0.3s ease;
      box-shadow: 0 6px 15px rgba(255, 99, 71, 0.6);
      border: 2px solid #FFD700; /* Gold border */
      color: white;
    }
    .btn-primary:hover {
      background-image: linear-gradient(to right, #FF4500, #FF6347);
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 8px 20px rgba(255, 99, 71, 0.8);
    }
    .btn-secondary {
      background-color: #4682B4; /* SteelBlue */
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(70, 130, 180, 0.4);
      border: 2px solid #ADD8E6; /* LightBlue border */
      color: white;
    }
    .btn-secondary:hover {
      background-color: #5F9EA0; /* CadetBlue */
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(70, 130, 180, 0.6);
    }
    .btn-success {
      background-color: #32CD32; /* LimeGreen */
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(50, 205, 50, 0.4);
      border: 2px solid #90EE90; /* LightGreen border */
      color: white;
    }
    .btn-success:hover {
      background-color: #3CB371; /* MediumSeaGreen */
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(50, 205, 50, 0.6);
    }
    .card {
      background-color: #FFFFFF; /* White card background */
      border: 3px solid #FFD700; /* Gold border */
      border-radius: 1.5rem; /* More rounded */
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      color: #333; /* Dark text inside cards */
    }
    .card:hover {
      transform: translateY(-8px) scale(1.01);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
    }
    input[type="text"], input[type="password"], input[type="email"], input[type="tel"], select, textarea {
      background-color: #F0F8FF; /* AliceBlue */
      border: 2px solid #ADD8E6; /* LightBlue */
      color: #333;
      border-radius: 0.75rem; /* Rounded inputs */
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="email"]:focus, input[type="tel"]:focus, select:focus, textarea:focus {
      border-color: #FF6347; /* Tomato */
      box-shadow: 0 0 0 3px rgba(255, 99, 71, 0.5);
    }
    .checkbox:checked {
      background-color: #FF6347; /* Tomato */
      border-color: #FF6347;
    }
    .checkbox:focus {
      box-shadow: 0 0 0 2px rgba(255, 99, 71, 0.5);
    }
    .status-pending { color: #FFD700; } /* Gold */
    .status-in-progress { color: #4682B4; } /* SteelBlue */
    .status-completed { color: #32CD32; } /* LimeGreen */

    .roblox-gradient {
        background-image: linear-gradient(to right, #00a2ff, #00c8ff);
    }
    .roblox-text-gradient {
        background-image: linear-gradient(to right, #00a2ff, #00c8ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }
    .pixel-font {
        font-family: 'Press Start 2P', cursive;
    }

    /* Mountain-themed elements using Font Awesome */
    .mountain-bg-icon {
        background-color: #6B8E23; /* OliveDrab for mountain base */
        position: relative;
        padding-bottom: 80px; /* Space for mountain peaks */
        border-bottom: none;
        overflow: hidden; /* Hide overflowing icons */
    }
    .mountain-peak-icon {
        position: absolute;
        bottom: -20px; /* Adjust to sit on the base */
        left: 0;
        width: 100%;
        display: flex;
        justify-content: space-around;
        align-items: flex-end;
        z-index: 10;
        pointer-events: none;
    }
    .mountain-peak-icon i {
        font-size: 80px; /* Size of mountain icons */
        color: #A9A9A9; /* DarkGray for mountain tops */
        text-shadow: 3px 3px #696969; /* DimGray shadow */
        transform: translateY(20px); /* Start slightly off-screen */
        animation: riseMountain 2s ease-out forwards;
    }
    .mountain-peak-icon i:nth-child(2) { animation-delay: 0.2s; font-size: 100px; color: #C0C0C0; }
    .mountain-peak-icon i:nth-child(3) { animation-delay: 0.4s; font-size: 70px; color: #B0C4DE; }

    @keyframes riseMountain {
        to { transform: translateY(0); }
    }

    .cloud-icon {
        position: absolute;
        top: 10%;
        left: -20%;
        font-size: 60px;
        color: rgba(255, 255, 255, 0.8);
        text-shadow: 2px 2px rgba(0, 0, 0, 0.2);
        animation: moveClouds 20s linear infinite;
        z-index: 5;
    }
    .cloud-icon:nth-child(2) {
        top: 30%;
        left: -50%;
        font-size: 80px;
        animation-delay: 5s;
        animation-duration: 25s;
    }
    .cloud-icon:nth-child(3) {
        top: 50%;
        left: -80%;
        font-size: 50px;
        animation-delay: 10s;
        animation-duration: 18s;
    }

    @keyframes moveClouds {
        0% { transform: translateX(0); }
        100% { transform: translateX(150vw); } /* Move across the screen */
    }

    .treasure-icon {
        position: absolute;
        top: -30px; /* Adjust to sit on the peak */
        right: 10%;
        font-size: 60px;
        color: #FFD700; /* Gold */
        text-shadow: 2px 2px #DAA520; /* Goldenrod */
        animation: bounce 2s infinite;
        z-index: 15;
    }

    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-20px); }
        60% { transform: translateY(-10px); }
    }

    .whatsapp-float {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
    }
    .whatsapp-float i {
        font-size: 60px;
        color: #25D366; /* WhatsApp green */
        background-color: white;
        border-radius: 50%;
        padding: 5px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        transition: transform 0.3s ease;
    }
    .whatsapp-float i:hover {
        transform: scale(1.1);
    }

    /* Animation for hero button */
    @keyframes bounce-slow {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
        60% { transform: translateY(-5px); }
    }
    .animate-bounce-slow {
        animation: bounce-slow 3s infinite;
    }
    /* Animation for money icon */
    @keyframes wiggle {
        0%, 7% { transform: rotateZ(0); }
        15% { transform: rotateZ(-15deg); }
        20% { transform: rotateZ(10deg); }
        25% { transform: rotateZ(-10deg); }
        30% { transform: rotateZ(6deg); }
        35% { transform: rotateZ(-3deg); }
        40%, 100% { transform: rotateZ(0); }
    }
    .animate-wiggle {
        animation: wiggle 2s infinite;
    }

  </style>
  <script type="text/javascript" src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
  <script type="module">
    // --- Firebase Setup (Updated to Compat v9 for Legacy Syntax) ---
    const firebaseConfig = {
      apiKey: "AIzaSyBdKELW2FNsL7H1zB8R765czcDPaSYybdg",
      authDomain: "atlantis-store.firebaseapp.com",
      databaseURL: "https://atlantis-store-default-rtdb.firebaseio.com",
      projectId: "atlantis-store",
      storageBucket: "atlantis-store.appspot.com",
      messagingSenderId: "566295949160",
      appId: "1:566295949160:web:3ad8956c753d2f05a5f0dd",
      measurementId: "G-F5RG09TFCK"
    };

    // Initialize Firebase only once
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    const auth = firebase.auth();
    const db = firebase.database();
    const storage = firebase.storage();

    // --- UI Elements ---
    const loginRegisterSection = document.getElementById("loginRegisterSection");
    const orderSection = document.getElementById("orderSection");
    const userDashboardSection = document.getElementById("userDashboardSection");
    const loginForm = document.getElementById("loginForm");
    const registerForm = document.getElementById("registerForm");
    const orderForm = document.getElementById("orderForm");
    const userEmailDisplay = document.getElementById("userEmailDisplay");
    const logoutBtn = document.getElementById("logoutBtn");
    const userOrdersList = document.getElementById("userOrdersList");
    const toggleLoginRegisterBtn = document.getElementById("toggleLoginRegister");
    const loginCard = document.getElementById("loginCard");
    const registerCard = document.getElementById("registerCard");

    // New UI Elements for dynamic order form
    const robloxJokiDetailsDiv = document.getElementById("robloxJokiDetails");
    const robloxUsernameInput = document.getElementById("robloxUsername");
    const mountainNameInput = document.getElementById("mountainName");
    const mountainQtyInput = document.getElementById("mountainQty");
    const robloxJokiPriceSpan = document.getElementById("robloxJokiPrice");
    const proofOfPaymentDiv = document.getElementById("proofOfPaymentDiv");


    // --- Toggle Login/Register View ---
    let isLoginView = true;
    if (toggleLoginRegisterBtn) {
        toggleLoginRegisterBtn.addEventListener('click', () => {
            isLoginView = !isLoginView;
            if (isLoginView) {
                loginCard.classList.remove('hidden');
                registerCard.classList.add('hidden');
                toggleLoginRegisterBtn.textContent = "Belum punya akun? Daftar yuk!";
            } else {
                loginCard.classList.add('hidden');
                registerCard.classList.remove('hidden');
                toggleLoginRegisterBtn.textContent = "Sudah punya akun? Masuk sini!";
            }
        });
    }


    // --- Auth State Listener ---
    auth.onAuthStateChanged((user) => {
      if (user) {
        // User is signed in
        loginRegisterSection.classList.add("hidden");
        orderSection.classList.remove("hidden");
        userDashboardSection.classList.remove("hidden");
        userEmailDisplay.textContent = user.email;
        fetchUserOrders(user.uid); // Fetch and display user's orders
        updateOrderDetails(); // Call this to set initial price and form visibility
      } else {
        // User is signed out
        loginRegisterSection.classList.remove("hidden");
        orderSection.classList.add("hidden");
        userDashboardSection.classList.add("hidden");
        userEmailDisplay.textContent = "";
        userOrdersList.innerHTML = ""; // Clear orders
        // Ensure login form is visible by default when logged out
        loginCard.classList.remove('hidden');
        registerCard.classList.add('hidden');
        if (toggleLoginRegisterBtn) {
            toggleLoginRegisterBtn.textContent = "Belum punya akun? Daftar yuk!";
            isLoginView = true;
        }
        // Hide specific order details when logged out
        robloxJokiDetailsDiv.classList.add('hidden'); // Hide Roblox details
        proofOfPaymentDiv.classList.add('hidden'); // Sembunyikan juga bukti pembayaran saat logout
      }
    });

    // --- Handle Login ---
    async function handleLogin(e) {
      e.preventDefault();
      const email = loginForm.loginEmail.value;
      const password = loginForm.loginPassword.value;

      if (!email || !password) {
        alert("Ups! Email dan kata sandi harus diisi ya.");
        return;
      }

      try {
        await auth.signInWithEmailAndPassword(email, password);
        alert("Hore! Login berhasil! Selamat datang kembali, petualang!");
        loginForm.reset();
      } catch (error) {
        console.error("Login gagal:", error);
        alert("Aduh, login gagal: " + error.message + ". Coba lagi ya!");
      }
    }

    // --- Handle Registration ---
    async function handleRegister(e) {
      e.preventDefault();
      const email = registerForm.registerEmail.value;
      const password = registerForm.registerPassword.value;

      if (!email || !password) {
        alert("Ups! Email dan kata sandi harus diisi ya.");
        return;
      }
      if (password.length < 6) {
        alert("Kata sandi harus minimal 6 karakter, biar aman!");
        return;
      }

      try {
        await auth.createUserWithEmailAndPassword(email, password);
        alert("Yeay! Pendaftaran berhasil! Sekarang kamu bisa masuk dengan akunmu.");
        registerForm.reset();
        // Automatically switch to login view after successful registration
        loginCard.classList.remove('hidden');
        registerCard.classList.add('hidden');
        if (toggleLoginRegisterBtn) {
            toggleLoginRegisterBtn.textContent = "Belum punya akun? Daftar yuk!";
            isLoginView = true;
        }
      } catch (error) {
        console.error("Registrasi gagal:", error);
        alert("Aduh, pendaftaran gagal: " + error.message + ". Coba lagi ya!");
      }
    }

    // --- Handle Logout ---
    async function handleLogout() {
      try {
        await auth.signOut();
        alert("Sampai jumpa lagi, petualang! Kamu sudah logout.");
      } catch (error) {
        console.error("Logout gagal:", error);
        alert("Aduh, logout gagal: " + error.message + ". Coba lagi ya!");
      }
    }

    // --- Function to update order details based on selection and user history ---
    async function updateOrderDetails() {
      const user = auth.currentUser;
      const jenis = document.getElementById("jenis").value;

      // Reset visibility for all specific service details
      robloxJokiDetailsDiv.classList.remove('hidden'); // Always visible for this page
      proofOfPaymentDiv.classList.remove('hidden'); // Always visible for this page

      // Reset required attributes for all specific inputs
      robloxUsernameInput.setAttribute('required', 'required');
      mountainNameInput.setAttribute('required', 'required');
      mountainQtyInput.setAttribute('required', 'required');
      document.getElementById("proof").setAttribute('required', 'required'); // Always required for this page

      // Update price dynamically for Roblox Joki
      const robloxPricePerMountain = 5000;
      const qty = parseInt(mountainQtyInput.value) || 1;
      robloxJokiPriceSpan.textContent = `Rp ${(robloxPricePerMountain * qty).toLocaleString('id-ID')}`;
    }

    // Event listener for mountain quantity change
    if (mountainQtyInput) {
      mountainQtyInput.addEventListener('input', () => {
        updateOrderDetails(); // Update price whenever quantity changes
      });
    }


    // --- Handle Order Form with Screenshot Upload ---
    async function handleOrder(e) {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) {
        alert("Ups! Kamu harus login dulu untuk pesan joki, ya.");
        return;
      }

      const jenis = document.getElementById("jenis").value;
      const device = document.getElementById("device").value;
      const whatsapp = document.getElementById("whatsapp").value;
      const agree = document.getElementById("agree").checked;

      if (!jenis || !device || !whatsapp) {
        alert("Semua kotak harus diisi ya, biar kami bisa bantu kamu!");
        return;
      }
      if (!agree) {
        alert("Jangan lupa centang kotak 'Aku sudah baca dan setuju' ya!");
        return;
      }

      // Basic WhatsApp number validation (starts with 62, min 10 digits)
      if (!whatsapp.match(/^62\d{9,}$/)) {
        alert("Nomor WhatsApp-nya kurang tepat nih. Coba pakai format 62xxxxxxxxxx (tanpa +) ya.");
        return;
      }

      // Show loading indicator (optional)
      const submitButton = orderForm.querySelector('button[type="submit"]');
      submitButton.disabled = true;
      submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Mendaki Order...';

      let proofURL = null;
      let orderPrice = 0; // Initialize order price

      try {
        // Handle proof of payment for 'roblox_mountain'
        const proofFile = document.getElementById("proof").files[0];
        if (!proofFile) {
          alert("Jangan lupa upload foto bukti pembayaran ya!");
          return;
        }
        const storageRef = storage.ref().child(`proofs/${user.uid}_${Date.now()}_${proofFile.name}`);
        const uploadTask = storageRef.put(proofFile);
        await new Promise((resolve, reject) => {
          uploadTask.on('state_changed', () => {}, (error) => reject(new Error("Gagal upload bukti pembayaran.")), resolve);
        });
        proofURL = await uploadTask.snapshot.ref.getDownloadURL();

        // Determine price and specific data based on service type
        const orderData = {
          userId: user.uid,
          nama: user.displayName || user.email.split('@')[0], // Use email prefix if no display name
          email: user.email,
          jenis,
          device,
          whatsapp: whatsapp,
          waktu: firebase.database.ServerValue.TIMESTAMP,
          status: "pending",
          proofURL: proofURL // Proof URL is common for paid services
        };

        if (jenis === 'roblox_mountain') {
          const robloxUsername = robloxUsernameInput.value;
          const mountainName = mountainNameInput.value;
          const mountainQty = parseInt(mountainQtyInput.value) || 1;
          const robloxPricePerMountain = 5000;

          if (!robloxUsername || !mountainName || !mountainQty) {
            alert("Wah, ada yang belum lengkap nih di detail joki gunung Roblox-nya!");
            return;
          }
          orderPrice = robloxPricePerMountain * mountainQty;

          orderData.robloxUsername = robloxUsername;
          orderData.mountainName = mountainName;
          orderData.mountainQty = mountainQty;
          orderData.price = orderPrice;
        }

        const newOrderRef = db.ref('orders').push();
        await newOrderRef.set(orderData);

        alert("Hore! Pesananmu sudah terkirim! Kami akan segera hubungi kamu lewat WhatsApp ya!");
        orderForm.reset();
        document.getElementById("proofPreview").innerHTML = ""; // Clear preview
        fetchUserOrders(user.uid); // Refresh user's orders
        updateOrderDetails(); // Re-evaluate prices/visibility
      } catch (error) {
        console.error('Order submission failed:', error);
        alert("Aduh, pesanan gagal terkirim: " + error.message + ". Coba lagi ya!");
      } finally {
        submitButton.disabled = false;
        submitButton.innerHTML = '<i class="fas fa-paper-plane mr-2"></i>Kirim Pesanan Petualangan!';
      }
    }

    // --- Fetch and Display User Orders ---
    function fetchUserOrders(userId) {
      userOrdersList.innerHTML = '<p class="text-gray-500 text-center py-4"><i class="fas fa-spinner fa-spin mr-2"></i>Memuat petualanganmu...</p>';
      // WARNING: For better performance, add ".indexOn": "userId" to your Firebase security rules at /orders
      db.ref('orders').orderByChild('userId').equalTo(userId).on('value', (snapshot) => {
        if (snapshot.exists()) {
          userOrdersList.innerHTML = ''; // Clear previous list
          const orders = [];
          snapshot.forEach((childSnapshot) => {
            orders.push({ id: childSnapshot.key, ...childSnapshot.val() });
          });

          // Sort orders by timestamp, newest first
          orders.sort((a, b) => b.waktu - a.waktu);

          orders.forEach((order) => {
            const orderElement = document.createElement('div');
            orderElement.className = 'card p-5 rounded-xl mb-4';
            let statusClass = '';
            switch (order.status) {
              case 'pending': statusClass = 'status-pending'; break;
              case 'in progress': statusClass = 'status-in-progress'; break;
              case 'completed': statusClass = 'status-completed'; break;
              default: statusClass = 'text-gray-500';
            }

            let orderDetailsHtml = '';
            if (order.jenis === 'roblox_mountain') {
                orderDetailsHtml = `
                    <p class="mb-1 text-gray-700"><i class="fab fa-roblox text-blue-500 mr-2"></i>Username Roblox: <span class="font-semibold">${order.robloxUsername || 'N/A'}</span></p>
                    <p class="mb-1 text-gray-700"><i class="fas fa-mountain text-green-500 mr-2"></i>Nama Gunung: <span class="font-semibold">${order.mountainName || 'N/A'}</span></p>
                    <p class="mb-1 text-gray-700"><i class="fas fa-hashtag text-purple-500 mr-2"></i>Jumlah Gunung: <span class="font-semibold">${order.mountainQty || 'N/A'}</span></p>
                    <p class="mb-1 text-gray-700"><i class="fas fa-coins text-yellow-500 mr-2"></i>Harga: <span class="font-bold text-green-600">Rp ${order.price ? order.price.toLocaleString('id-ID') : 'N/A'}</span></p>
                    ${order.proofURL ? `<a href="${order.proofURL}" target="_blank" class="text-red-500 hover:underline text-sm mt-3 block"><i class="fas fa-image mr-1"></i>Lihat Bukti Pembayaran</a>` : ''}
                `;
            }


            orderElement.innerHTML = `
              <div class="flex justify-between items-center mb-3 border-b border-gray-300 pb-2">
                <h5 class="text-lg font-bold text-orange-500">ID Petualangan: <span class="text-gray-600 text-sm">${order.id}</span></h5>
                <span class="text-sm font-semibold ${statusClass}">${order.status.toUpperCase()}</span>
              </div>
              <p class="mb-1 text-gray-700"><i class="fas fa-gamepad text-blue-500 mr-2"></i>Jenis Joki: <span class="font-semibold">Joki Gendong Naik Gunung Roblox</span></p>
              <p class="mb-1 text-gray-700"><i class="fas fa-mobile-alt text-blue-500 mr-2"></i>Main di: <span class="font-semibold">${order.device}</span></p>
              <p class="mb-1 text-gray-700"><i class="fab fa-whatsapp text-green-500 mr-2"></i>WhatsApp: <span class="font-semibold">${order.whatsapp}</span></p>
              ${orderDetailsHtml}
              <p class="text-sm text-gray-500 mt-2">Waktu Pesan: ${new Date(order.waktu).toLocaleString()}</p>
            `;
            userOrdersList.appendChild(orderElement);
          });
        } else {
          userOrdersList.innerHTML = '<p class="text-gray-500 text-center py-4">Belum ada petualangan yang kamu pesan nih. Yuk, mulai!</p>';
        }
      }, (error) => {
        console.error("Error fetching user orders:", error);
        userOrdersList.innerHTML = '<p class="text-red-500 text-center py-4">Aduh, gagal memuat petualanganmu. Coba lagi ya!</p>';
      });
    }

    // Preview screenshot on select
    function previewProof(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          document.getElementById("proofPreview").innerHTML = `<img src="${e.target.result}" alt="Preview Bukti Pembayaran" class="max-w-full h-48 object-cover rounded-lg mt-2 border border-gray-300 shadow-md">`;
        };
        reader.readAsDataURL(file);
      } else {
        document.getElementById("proofPreview").innerHTML = "";
      }
    }

    // Call updateOrderDetails on page load to set initial state for Roblox Joki
    document.addEventListener('DOMContentLoaded', () => {
        // Set the default selected option to Roblox Joki
        const jenisSelect = document.getElementById("jenis");
        if (jenisSelect) {
            jenisSelect.value = 'roblox_mountain';
            updateOrderDetails();
        }
    });


    // Expose functions to the global scope
    window.handleLogin = handleLogin;
    window.handleRegister = handleRegister;
    window.handleLogout = handleLogout;
    window.handleOrder = handleOrder;
    window.previewProof = previewProof;
    window.updateOrderDetails = updateOrderDetails; // Expose new update function
  </script>
</head>
<body class="flex flex-col min-h-screen">
  <!-- Floating WhatsApp Button -->
  <a href="https://wa.me/6289634568406" target="_blank" class="whatsapp-float">
    <i class="fab fa-whatsapp"></i>
  </a>

  <!-- Header -->
  <header class="bg-gradient-to-b from-[#87CEEB] to-[#ADD8E6] p-4 md:p-6 text-center shadow-2xl border-b-4 border-[#FFD700] relative overflow-hidden">
    <i class="fas fa-cloud cloud-icon"></i>
    <i class="fas fa-cloud cloud-icon" style="animation-delay: 7s; left: -30%; top: 40%; font-size: 80px;"></i>
    <i class="fas fa-cloud cloud-icon" style="animation-delay: 14s; left: -60%; top: 20%; font-size: 50px;"></i>

    <div class="flex justify-center items-center space-x-3 mb-2 relative z-20">
      <i class="fab fa-roblox text-5xl text-white animate-bounce" style="text-shadow: 2px 2px #00a2ff;"></i>
      <h1 class="text-4xl md:text-6xl font-bold header-title tracking-wide">Joki Gendong <span class="roblox-text-gradient">Roblox</span></h1>
    </div>
    <p class="text-lg md:text-xl text-white relative z-20" style="text-shadow: 1px 1px #333;">Mizuki Hiroshi Ch. - Siap Gendong Kamu ke Puncak Kemenangan!</p>
    <div class="mountain-peak-icon">
        <i class="fas fa-mountain"></i>
        <i class="fas fa-mountain"></i>
        <i class="fas fa-mountain"></i>
    </div>
  </header>

  <!-- Main Content -->
  <main class="flex-grow container mx-auto p-6 md:p-8">

    <!-- Hero Section - Lebih Lucu dan Tema Gunung -->
    <section class="p-6 md:p-8 text-center roblox-gradient shadow-xl rounded-xl mb-12 transform hover:scale-105 transition-transform duration-300 relative overflow-hidden mountain-bg-icon">
      <div class="absolute inset-0 bg-black opacity-30 z-0"></div> <!-- Overlay for text readability -->
      <div class="relative z-10">
        <div class="flex justify-center items-center space-x-3 mb-3">
          <i class="fas fa-mountain text-4xl text-white animate-pulse"></i>
          <h2 class="text-3xl md:text-5xl font-bold text-white pixel-font" style="text-shadow: 3px 3px #FFD700;">AYO TAKLUKKAN PUNCAK!</h2>
        </div>
        <p class="text-xl md:text-3xl text-white mb-4" style="text-shadow: 1px 1px #333;">Kami siap gendong kamu melewati rintangan terjal dan sampai di puncak gunung Roblox impianmu!</p>
        <p class="text-4xl md:text-6xl font-bold text-yellow-300 mb-4 pixel-font" style="text-shadow: 4px 4px #FF4500;">Mulai dari Rp 5.000 / gunung!</p>
        <button onclick="document.getElementById('orderSection').scrollIntoView({ behavior: 'smooth' });" class="btn-primary text-white px-8 py-3 rounded-full font-semibold text-lg shadow-lg animate-bounce-slow">
          <i class="fas fa-hiking mr-2"></i>Mulai Petualanganmu Sekarang!
        </button>
        <i class="fas fa-gem treasure-icon"></i> <!-- Mengganti peti harta karun dengan ikon permata -->
      </div>
    </section>

    <!-- Kenapa Pilih Kami? - Lebih Ceria -->
    <section class="mb-12">
      <h3 class="text-2xl md:text-4xl font-bold mb-8 text-center roblox-text-gradient flex items-center justify-center space-x-3">
        <i class="fas fa-star-of-life text-yellow-500 animate-spin"></i>
        <span>Kenapa Harus Kami yang Gendong?</span>
      </h3>
      <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
        <div class="card p-8 rounded-xl text-center">
          <i class="fas fa-rocket text-5xl text-red-500 mb-4 animate-pulse"></i>
          <h4 class="text-2xl font-semibold mb-3 text-orange-600 pixel-font">SUPER CEPAT!</h4>
          <p class="text-gray-700">Gunung setinggi apapun, kami daki secepat kilat! Kamu tinggal santai.</p>
        </div>
        <div class="card p-8 rounded-xl text-center">
          <i class="fas fa-lock text-5xl text-blue-500 mb-4"></i>
          <h4 class="text-2xl font-semibold mb-3 text-orange-600 pixel-font">SUPER AMAN!</h4>
          <p class="text-gray-700">Akun Roblox-mu kami jaga seperti harta karun. Dijamin aman sentosa!</p>
        </div>
        <div class="card p-8 rounded-xl text-center">
          <i class="fas fa-coins text-5xl text-green-500 mb-4 animate-wiggle"></i>
          <h4 class="text-2xl font-semibold mb-3 text-orange-600 pixel-font">SUPER HEMAT!</h4>
          <p class="text-gray-700">Harga mulai dari Rp 5.000 aja, kamu bisa jadi Raja Gunung Roblox!</p>
        </div>
      </div>
    </section>

    <!-- Login/Register Section -->
    <section id="loginRegisterSection" class="max-w-2xl mx-auto mb-12">
      <h3 class="text-2xl md:text-4xl font-bold mb-8 text-center roblox-text-gradient flex items-center justify-center space-x-3">
        <i class="fas fa-user-astronaut text-purple-500"></i>
        <span>Gerbang Petualanganmu!</span>
      </h3>
      <div class="card p-8 rounded-xl">
        <div id="loginCard">
          <h4 class="text-xl font-semibold mb-6 text-center text-orange-600 pixel-font">Masuk ke Markas Rahasia</h4>
          <form id="loginForm" onsubmit="handleLogin(event)" class="space-y-5">
            <div>
              <label for="loginEmail" class="block text-sm font-medium mb-2 text-gray-700">Email Ajaibmu</label>
              <input type="email" id="loginEmail" class="w-full p-3 rounded-lg focus:outline-none" required placeholder="Contoh: petualang@roblox.com">
            </div>
            <div>
              <label for="loginPassword" class="block text-sm font-medium mb-2 text-gray-700">Kata Sandi Rahasia</label>
              <input type="password" id="loginPassword" class="w-full p-3 rounded-lg focus:outline-none" required placeholder="Jangan sampai lupa ya!">
            </div>
            <button type="submit" class="btn-primary w-full text-white px-6 py-3 rounded-lg font-bold text-lg">
              <i class="fas fa-door-open mr-2"></i>Masuk Sekarang!
            </button>
          </form>
        </div>
        <div id="registerCard" class="hidden">
          <h4 class="text-xl font-semibold mb-6 text-center text-orange-600 pixel-font">Buat Akun Petualang Baru</h4>
          <form id="registerForm" onsubmit="handleRegister(event)" class="space-y-5">
            <div>
              <label for="registerEmail" class="block text-sm font-medium mb-2 text-gray-700">Email Ajaibmu</label>
              <input type="email" id="registerEmail" class="w-full p-3 rounded-lg focus:outline-none" required placeholder="Contoh: petualangbaru@roblox.com">
            </div>
            <div>
              <label for="registerPassword" class="block text-sm font-medium mb-2 text-gray-700">Kata Sandi Rahasia (min. 6 karakter)</label>
              <input type="password" id="registerPassword" class="w-full p-3 rounded-lg focus:outline-none" required placeholder="Yang kuat ya kata sandinya!">
            </div>
            <button type="submit" class="btn-secondary w-full text-white px-6 py-3 rounded-lg font-bold text-lg">
              <i class="fas fa-user-plus mr-2"></i>Daftar Jadi Petualang!
            </button>
          </form>
        </div>
        <button id="toggleLoginRegister" class="mt-6 w-full text-center text-gray-600 hover:text-roblox-gradient transition-colors duration-200 text-sm">
          Belum punya akun? Daftar yuk!
        </button>
      </div>
    </section>

    <!-- User Dashboard Section (Hidden until logged in) -->
    <section id="userDashboardSection" class="hidden max-w-4xl mx-auto mb-12">
      <div class="card p-8 rounded-xl">
        <div class="flex flex-col md:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-300">
          <h3 class="text-2xl md:text-3xl font-bold roblox-text-gradient flex items-center space-x-3 mb-4 md:mb-0">
            <i class="fas fa-map-marked-alt text-green-500"></i>
            <span>Peta Petualanganmu!</span>
          </h3>
          <div class="flex items-center space-x-4">
            <span class="text-gray-700 text-lg">Halo, <span id="userEmailDisplay" class="font-semibold text-orange-500"></span>!</span>
            <button id="logoutBtn" onclick="handleLogout()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors duration-300">
              <i class="fas fa-sign-out-alt mr-1"></i>Cabut Dulu!
            </button>
          </div>
        </div>

        <h4 class="text-xl font-bold mb-5 text-orange-500 flex items-center space-x-2">
          <i class="fas fa-scroll text-yellow-500"></i>
          <span>Catatan Petualanganmu</span>
        </h4>
        <div id="userOrdersList" class="space-y-4">
          <!-- User orders will be loaded here -->
          <p class="text-gray-500 text-center py-4"><i class="fas fa-spinner fa-spin mr-2"></i>Memuat catatan petualangan...</p>
        </div>
      </div>
    </section>

    <!-- Form Order (Hidden until logged in) -->
    <section id="orderSection" class="hidden max-w-2xl mx-auto mb-12">
      <h3 class="text-2xl md:text-4xl font-bold mb-8 text-center roblox-text-gradient flex items-center justify-center space-x-3">
        <i class="fas fa-compass text-red-500"></i>
        <span>Formulir Pesanan Joki Gunung Roblox</span>
      </h3>
      <form id="orderForm" onsubmit="handleOrder(event)" class="card p-8 rounded-xl space-y-6">
        <!-- Hidden input for jenis, always roblox_mountain for this page -->
        <input type="hidden" id="jenis" value="roblox_mountain">

        <!-- Input Spesifik untuk Joki Gendong Naik Gunung Roblox -->
        <div id="robloxJokiDetails" class="space-y-6">
            <p class="text-lg font-bold text-orange-600 mb-2 pixel-font">Detail Petualangan Gunungmu:</p>
            <div>
                <label for="robloxUsername" class="block text-sm font-medium mb-2 text-gray-700">Nama Petualang Roblox-mu</label>
                <input type="text" id="robloxUsername" class="w-full p-3 rounded-lg focus:outline-none transition-all duration-200" placeholder="Contoh: HiroGamer123" required>
            </div>
            <div>
                <label for="mountainName" class="block text-sm font-medium mb-2 text-gray-700">Nama Gunung yang Mau Ditaklukkan</label>
                <input type="text" id="mountainName" class="w-full p-3 rounded-lg focus:outline-none transition-all duration-200" placeholder="Contoh: Gunung Sakura, Gunung Berapi" required>
            </div>
            <div>
                <label for="mountainQty" class="block text-sm font-medium mb-2 text-gray-700">Berapa Banyak Gunung yang Mau Didaki?</label>
                <input type="number" id="mountainQty" class="w-full p-3 rounded-lg focus:outline-none transition-all duration-200" min="1" value="1" oninput="updateOrderDetails()" required>
            </div>
            <p class="text-lg font-bold text-orange-600 mb-2 pixel-font">Total Biaya Petualangan:</p>
            <p id="robloxJokiPrice" class="text-3xl font-bold text-green-600 pixel-font">Rp 5.000</p>
            <p class="text-sm text-gray-600 mt-1">Harga: Rp 5.000 / gunung. Semakin banyak gunung, semakin seru dan cepat sampai puncak!</p>

            <!-- Payment Methods for Roblox Joki -->
            <div class="mt-6 p-4 bg-[#F0F8FF] rounded-lg border border-[#ADD8E6]">
                <h5 class="text-xl font-bold text-orange-600 mb-3 flex items-center space-x-2 pixel-font">
                  <i class="fas fa-coins text-yellow-500"></i>
                  <span>Cara Bayar Koin Petualangan</span>
                </h5>
                <ul class="space-y-2 text-gray-700">
                  <li class="flex items-center space-x-2">
                    <i class="fas fa-money-bill-wave text-green-500"></i>
                    <span>DANA: <span class="font-semibold">089634568406</span></span>
                  </li>
                  <li class="flex items-center space-x-2">
                    <i class="fas fa-money-bill-wave text-green-500"></i>
                    <span>Gopay: <span class="font-semibold">089634568406</span></span>
                  </li>
                  <li class="flex items-center space-x-2">
                    <i class="fas fa-money-bill-wave text-green-500"></i>
                    <span>OVO: <span class="font-semibold">089634568406</span></span>
                  </li>
                  <li class="flex items-center space-x-2">
                    <i class="fas fa-university text-blue-500"></i>
                    <span>BRI: <span class="font-semibold">079801006323504</span></span>
                  </li>
                  <li class="flex items-center space-x-2">
                    <i class="fas fa-university text-blue-500"></i>
                    <span>BCA: <span class="font-semibold">4460995146</span></span>
                  </li>
                  <li class="flex items-center space-x-2">
                    <i class="fas fa-hand-holding-heart text-red-500"></i>
                    <span>Trakteer: <a href="https://trakteer.id/itshiro16/tip" target="_blank" class="text-red-500 hover:underline font-semibold">trakteer.id/itshiro16/tip</a></span>
                  </li>
                  <li class="flex items-center space-x-2">
                    <i class="fas fa-hand-holding-usd text-yellow-500"></i>
                    <span>Saweria: <a href="https://saweria.co/mizukikun" target="_blank" class="text-yellow-500 hover:underline font-semibold">saweria.co/mizukikun</a></span>
                  </li>
                </ul>
                <p class="text-sm text-gray-600 mt-3">Jangan lupa bayar dulu ya, baru upload foto bukti pembayarannya!</p>
              </div>
        </div>

        <div>
          <label for="device" class="block text-sm font-medium mb-2 text-gray-700">Kamu Main Petualangan di Mana?</label>
          <select id="device" class="w-full p-3 rounded-lg focus:outline-none transition-all duration-200" required>
            <option value="android">HP Android</option>
            <option value="ios">iPhone / iPad</option>
            <option value="pc">Komputer / Laptop</option>
          </select>
        </div>
        <div>
          <label for="whatsapp" class="block text-sm font-medium mb-2 text-gray-700">Nomor WhatsApp Rahasiamu (Cth: 6281234567890)</label>
          <input type="tel" id="whatsapp" class="w-full p-3 rounded-lg focus:outline-none transition-all duration-200" required placeholder="Nomor WhatsApp aktifmu (tanpa +)">
          <p class="text-xs text-gray-600 mt-1">Kami akan kirim update petualanganmu ke nomor ini!</p>
        </div>
        <div id="proofOfPaymentDiv">
          <label for="proof" class="block text-sm font-medium mb-2 text-gray-700">Foto Bukti Pembayaran (Wajib!) <i class="fas fa-camera text-blue-500"></i></label>
          <input type="file" id="proof" accept="image/*" class="w-full p-3 rounded-lg focus:outline-none file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-roblox-gradient file:text-white hover:file:bg-[#0080c0] transition-all duration-200" onchange="previewProof(event)" required>
          <div id="proofPreview" class="mt-4 flex justify-center"></div>
        </div>
        <div class="flex items-center space-x-3 p-4 card rounded-lg bg-yellow-100 border-yellow-400">
          <input type="checkbox" id="agree" class="w-5 h-5 rounded checkbox focus:ring-offset-2 focus:ring-offset-[#87CEEB]">
          <label for="agree" class="text-sm text-gray-800">Aku sudah baca dan setuju <a href="#rules" class="roblox-text-gradient underline hover:text-[#0080c0] transition-colors duration-200 font-bold">aturan mainnya</a>!</label>
        </div>
        <button type="submit" class="btn-primary w-full text-white px-6 py-3 rounded-lg font-bold text-lg">
          <i class="fas fa-paper-plane mr-2"></i>Kirim Pesanan Petualangan!
        </button>
      </form>
    </section>

    <!-- Informasi & Rules - Lebih Ramah Anak -->
    <section id="rules" class="max-w-4xl mx-auto mt-12">
      <h3 class="text-2xl md:text-4xl font-bold mb-8 text-center roblox-text-gradient flex items-center justify-center space-x-3">
        <i class="fas fa-book-open text-brown-500"></i>
        <span>Buku Panduan Petualangan & Aturan Main</span>
      </h3>
      <div class="card p-8 rounded-xl bg-yellow-50">
        <h4 class="text-xl font-bold mb-4 text-orange-600 pixel-font">Informasi Penting untuk Petualang:</h4>
        <ul class="space-y-4 text-gray-700 list-disc pl-5 mb-8">
          <li class="flex items-start space-x-3">
            <i class="fas fa-star text-yellow-500 mt-1"></i>
            <div>
              <b>Joki Gendong Naik Gunung Roblox</b> – Harga <span class="font-bold text-green-600">Rp 5.000</span> per gunung. Murah meriah, bisa buat jajan!
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-hourglass-half text-blue-500 mt-1"></i>
            <span>Kami akan gendong kamu secepat mungkin! Kalau ada update, kami langsung kabari lewat WhatsApp.</span>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-shield-alt text-purple-500 mt-1"></i>
            <span>Akun Roblox-mu aman banget! Kami jaga baik-baik seperti harta karun.</span>
          </li>
        </ul>

        <h4 class="text-xl font-bold mb-4 text-orange-600 pixel-font">Aturan Main Petualangan:</h4>
        <ol class="list-decimal pl-8 space-y-3 text-gray-700">
          <li class="flex items-start space-x-3">
            <i class="fas fa-money-check-alt text-green-500 mt-1"></i>
            <div>
              <b>Bayar Dulu, Baru Digendong!</b><br>
              Petualangan mendaki gunung baru dimulai setelah pembayaranmu dikonfirmasi ya.
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-child-reaching text-blue-500 mt-1"></i>
            <div>
              <b>Kamu Cukup Santai Aja!</b><br>
              Penjoki kami akan gendong kamu dari base camp sampai puncak. Kamu cukup diam atau AFK (Away From Keyboard) saja, tidak perlu banyak gerak.
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-hand-point-up text-yellow-500 mt-1"></i>
            <div>
              <b>Ikuti Komando Penjoki!</b><br>
              Kalau ada instruksi khusus (misalnya "Lompat!" atau "Rejoin Server!"), kamu wajib ikuti ya. Gerakan sembarangan bisa bikin kamu jatuh dan petualangan dianggap selesai tanpa uang kembali. Hati-hati!
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-clock text-purple-500 mt-1"></i>
            <div>
              <b>Waktu Sampai Puncak</b><br>
              Waktu yang dibutuhkan untuk sampai puncak tergantung kondisi server. Rata-rata sekitar 10–20 menit per gunung. Sabar ya, perjalanan seru butuh waktu!
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-undo-alt text-red-500 mt-1"></i>
            <div>
              <b>Aturan Uang Kembali (Refund)</b><br>
              Uangmu akan kembali jika penjoki gagal menggendong karena masalah teknis (error/bug/disconnect). Tapi, kalau kamu jatuh karena bergerak sendiri, maaf ya, uang tidak bisa kembali.
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-mountain text-green-500 mt-1"></i>
            <div>
              <b>Satu Gunung = Satu Harga</b><br>
              Harga yang tertera berlaku untuk satu gunung (misalnya: Rp5.000 per puncak). Kalau mau lanjut ke gunung lain, itu dihitung sebagai jasa baru ya.
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-users-line text-blue-500 mt-1"></i>
            <div>
              <b>Antrean Petualang</b><br>
              Kalau banyak teman-teman lain yang juga mau digendong, kami akan pakai sistem antrean. Admin kami akan memberitahu kapan giliranmu tiba.
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-user-secret text-gray-500 mt-1"></i>
            <div>
              <b>Privasi Aman Terjamin!</b><br>
              Kami tidak butuh data sensitifmu. Kamu cukup join game, dan kami langsung siap gendong!
            </div>
          </li>
          <li class="flex items-start space-x-3">
            <i class="fas fa-check-circle text-green-500 mt-1"></i>
            <div>
              Dengan pesan joki, berarti kamu sudah setuju dengan semua aturan main ini. Siap berpetualang?
            </div>
          </li>
        </ol>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="text-center p-6 mt-12 text-gray-600 border-t-4 border-[#FFD700] bg-[#ADD8E6]">
    <p>© 2025 Mizuki Hiroshi Ch. | Joki Gendong Roblox | <a href="https://wa.me/6289634568406" class="text-green-600 underline hover:text-green-500 transition-colors duration-200 font-bold">Yuk, Ngobrol!</a></p>
  </footer>
</body>
</html>
